# IAM Role Enumerator

This project is a Python-based tool designed to enumerate IAM roles in a specific AWS account, given the account ID. By leveraging AWS permissions, the script attempts to update the AssumeRole policy document of a provided or newly created role to discover existing roles within the target account.

## Highlights

One of the key features of this tool is its **stealthiness**: it does not leave any traces in the target account's CloudTrail logs. This ensures that your role enumeration efforts remain completely undetected from the target account.

As you might notice that This tool is heavily inspired by and owes much of its implementation to the PACU framework. But we still tried to make some improvements based on PACU Fantastic job.

1. **Improved Wordlist for Higher Success Rate**  
   The latest wordlist is generated by extracting role names mentioned in public GitHub repositories using [Sourcegraph](https://sourcegraph.com). This significantly increases the likelihood of successfully brute-forcing IAM roles.

2. **Simplified PACU Module**  
   This project refactors the original PACU module into a standalone Python script, making it easier to modify script features and bypass malicious script detection mechanisms.

3. **Abandoned Multiprocessing for AWS Rate Limits**  
   Although attempts were made to use multiprocessing to speed up brute force, this approach was abandoned due to hitting AWS's rate limits. The current implementation is optimized for performance within these constraints.

## Features

- Enumerates IAM roles in a specified AWS account using `iam:UpdateAssumeRolePolicy` and `sts:AssumeRole` permissions.
- Utilizes a customizable word list to guess IAM role names.
- Outputs discovered roles for further analysis.

## Usage

To use this tool, you must have an AWS account with sufficient permissions:

1. `iam:UpdateAssumeRolePolicy` on the role being used or created.
2. `sts:AssumeRole` to attempt to assume enumerated roles.

You can execute the script as follows:

```bash
python3 iam_enum_roles.py --account-id <TARGET_ACCOUNT_ID> --profile <AWS_PROFILE> --role-name <EXISTING_ROLE_NAME>
```

## Arguments

--account-id: Required. The AWS account ID of the target account (12 numeric characters).
--profile: Optional. AWS CLI profile to use for authentication. Default: default.
--role-name: Optional. Name of an existing IAM role in your account. If not provided, a temporary role will be created.
--word-list: Optional. Path to a word list file containing role names to test. Default: ./default-word-list.txt.

## Credits

This tool is heavily inspired by and owes much of its implementation to the PACU framework, a powerful AWS exploitation framework. We are deeply grateful for their pioneering work and tools that made this project possible.

## Disclaimer

This project is for educational and research purposes only. Ensure you have proper authorization before using it on any AWS account.
